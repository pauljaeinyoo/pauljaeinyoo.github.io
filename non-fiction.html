<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Non-Fiction Books - BookFlow</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Braze SDK -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js');
        }

        +function(a,p,P,b,y){
            a.braze={};a.brazeQueue=[];
            const s="BrazeSdkMetadata DeviceProperties Card Card.prototype.dismissCard Card.prototype.removeAllSubscriptions Card.prototype.removeSubscription Card.prototype.subscribeToClickedEvent Card.prototype.subscribeToDismissedEvent Card.fromContentCardsJson ImageOnly CaptionedImage ClassicCard ControlCard ContentCards ContentCards.prototype.getUnviewedCardCount Feed Feed.prototype.getUnreadCardCount ControlMessage InAppMessage InAppMessage.SlideFrom InAppMessage.ClickAction InAppMessage.DismissType InAppMessage.OpenTarget InAppMessage.ImageStyle InAppMessage.Orientation InAppMessage.TextAlignment InAppMessage.CropType InAppMessage.prototype.closeMessage InAppMessage.prototype.removeAllSubscriptions InAppMessage.prototype.removeSubscription InAppMessage.prototype.subscribeToClickedEvent InAppMessage.prototype.subscribeToDismissedEvent InAppMessage.fromJson FullScreenMessage ModalMessage HtmlMessage SlideUpMessage User User.Genders User.NotificationSubscriptionTypes User.prototype.addAlias User.prototype.addToCustomAttributeArray User.prototype.addToSubscriptionGroup User.prototype.getUserId User.prototype.incrementCustomUserAttribute User.prototype.removeFromCustomAttributeArray User.prototype.removeFromSubscriptionGroup User.prototype.setCountry User.prototype.setCustomLocationAttribute User.prototype.setCustomUserAttribute User.prototype.setDateOfBirth User.prototype.setEmail User.prototype.setEmailNotificationSubscriptionType User.prototype.setFirstName User.prototype.setGender User.prototype.setHomeCity User.prototype.setLanguage User.prototype.setLastKnownLocation User.prototype.setLastName User.prototype.setPhoneNumber User.prototype.setPushNotificationSubscriptionType InAppMessageButton InAppMessageButton.prototype.removeAllSubscriptions InAppMessageButton.prototype.removeSubscription InAppMessageButton.prototype.subscribeToClickedEvent FeatureFlag FeatureFlag.prototype.getStringProperty FeatureFlag.prototype.getNumberProperty FeatureFlag.prototype.getBooleanProperty automaticallyShowInAppMessages destroyFeed hideContentCards showContentCards showFeed showInAppMessage deferInAppMessage toggleContentCards toggleFeed changeUser destroy getDeviceId initialize isPushBlocked isPushPermissionGranted isPushSupported logCardClick logCardDismissal logCardImpressions logContentCardImpressions logContentCardClick logCustomEvent logFeedDisplayed logInAppMessageButtonClick logInAppMessageClick logInAppMessageHtmlClick logInAppMessageImpression logPurchase openSession requestPushPermission removeAllSubscriptions removeSubscription requestContentCardsRefresh requestFeedRefresh refreshFeatureFlags requestImmediateDataFlush enableSDK isDisabled setLogger setSdkAuthenticationSignature addSdkMetadata disableSDK subscribeToContentCardsUpdates subscribeToFeedUpdates subscribeToInAppMessage subscribeToSdkAuthenticationFailures toggleLogging unregisterPush wipeData handleBrazeAction subscribeToFeatureFlagsUpdates getAllFeatureFlags logFeatureFlagImpression"
            .split(" ");
            for (var i = 0; i < s.length; i++) {
                var m = s[i], k = a.braze, l = m.split(".");
                for (var j = 0; j < l.length - 1; j++) k = k[l[j]];
                k[l[j]] = new Function("return function " + m.replace(/\./g, "_") +
                    "(){window.brazeQueue.push(arguments); return true}")();
            }
            y = p.createElement(P);
            y.type = 'text/javascript';
            y.src = 'https://js.appboycdn.com/web-sdk/5.1/braze.min.js';
            y.async = 1;
            b = p.getElementsByTagName(P)[0];
            b.parentNode.insertBefore(y, b);
        }(window, document, 'script');
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #111111;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        .navbar {
            background: #ffffff;
            border-bottom: 1px solid #e5e5e5;
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 0;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            height: 80px;
        }

        .nav-left .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 800;
            color: #111111;
        }

        .nav-left .logo i {
            color: #ff6b35;
        }

        .nav-center {
            display: flex;
            gap: 40px;
        }

        .nav-link {
            text-decoration: none;
            color: #111111;
            font-weight: 500;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #ff6b35;
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: 0;
            width: 100%;
            height: 3px;
            background: #ff6b35;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-bar {
            display: flex;
            align-items: center;
            background: #f5f5f5;
            border-radius: 25px;
            padding: 10px 20px;
            gap: 10px;
        }

        .search-bar input {
            border: none;
            background: none;
            outline: none;
            font-size: 0.9rem;
            width: 200px;
        }

        .search-bar i {
            color: #666;
        }

        .search-clear-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .search-clear-btn:hover {
            background: #e5e5e5;
            color: #333;
        }

        /* Search Results Section */
        .search-results-section {
            background: #f8f9fa;
            padding: 40px 0;
            border-bottom: 1px solid #e5e5e5;
        }

        .search-results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .search-results-header h2 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #111111;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-search-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #666;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-search-btn:hover {
            background: #e5e5e5;
            color: #333;
        }

        .search-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .search-result-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .search-result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .search-result-image {
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .search-result-info {
            padding: 20px;
        }

        .search-result-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #111111;
        }

        .search-result-author {
            color: #666;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .search-result-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: #ff6b35;
            margin-bottom: 15px;
        }

        .search-result-cta {
            background: #111111;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .search-result-cta:hover {
            background: #ff6b35;
        }

        .nav-actions {
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #111111;
            cursor: pointer;
            position: relative;
            padding: 10px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .nav-btn:hover {
            background: #f5f5f5;
        }

        .cart-count {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff6b35;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
            text-align: center;
        }

        .page-header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 20px;
        }

        .page-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Books Grid */
        .books-section {
            padding: 80px 0;
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 40px;
        }

        .book-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .book-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .book-image {
            height: 350px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            position: relative;
        }

        .book-image::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 5px;
        }

        .book-info {
            padding: 25px;
        }

        .book-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #111111;
        }

        .book-author {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .book-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ff6b35;
            margin-bottom: 20px;
        }

        .add-to-cart-btn {
            background: #111111;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .add-to-cart-btn:hover {
            background: #ff6b35;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
            z-index: 1001;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            padding: 30px;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111111;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .cart-items {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item-image {
            width: 60px;
            height: 80px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 5px;
            flex-shrink: 0;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #111111;
        }

        .cart-item-price {
            color: #ff6b35;
            font-weight: 600;
        }

        .cart-footer {
            padding: 30px;
            border-top: 1px solid #e5e5e5;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #111111;
        }

        .checkout-btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
        }

        .checkout-btn:hover {
            background: #e55a2b;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 15px;
                height: 60px;
            }

            .nav-center {
                display: none;
            }

            .search-bar input {
                width: 150px;
            }

            .search-results-section {
                padding: 30px 0;
            }

            .search-results-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .search-results-header h2 {
                font-size: 1.5rem;
            }

            .search-results-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }

            .search-result-image {
                height: 150px;
            }

            .search-result-info {
                padding: 15px;
            }

            .search-result-title {
                font-size: 1.1rem;
            }

            .page-header h1 {
                font-size: 2.5rem;
            }

            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-left">
                <div class="logo">
                    <a href="index.html" style="text-decoration: none; color: inherit;">
                        <i class="fas fa-book-open"></i>
                        <span>BookFlow</span>
                    </a>
                </div>
            </div>
            <div class="nav-center">
                <a href="index.html" class="nav-link">New & Featured</a>
                <a href="fiction.html" class="nav-link">Fiction</a>
                <a href="non-fiction.html" class="nav-link active">Non-Fiction</a>
                <a href="sci-fi.html" class="nav-link">Science Fiction</a>
                <a href="biography.html" class="nav-link">Biography</a>
                <a href="self-help.html" class="nav-link">Self-Help</a>
            </div>
            <div class="nav-right">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search for books..." id="search-input" onkeyup="searchBooks()">
                    <button class="search-clear-btn" onclick="clearSearch()" id="search-clear-btn" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="nav-actions">
                    <button class="nav-btn" onclick="showCart()">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="cart-count" id="cart-count">0</span>
                    </button>
                    <button class="nav-btn" onclick="showUserMenu()">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Search Results Section -->
    <section class="search-results-section" id="search-results-section" style="display: none;">
        <div class="container">
            <div class="search-results-header">
                <h2><i class="fas fa-search"></i> Search Results</h2>
                <button class="close-search-btn" onclick="closeSearchResults()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="search-results-grid" id="search-results-grid">
                <!-- Search results will be populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>NON-FICTION BOOKS</h1>
            <p>Explore real-world knowledge, insights, and discoveries that expand your understanding of the world around you.</p>
        </div>
    </section>

    <!-- Books Section -->
    <section class="books-section">
        <div class="container">
            <div class="books-grid" id="books-grid">
                <!-- Books will be populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Shopping Cart Sidebar -->
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3>Shopping Cart</h3>
            <button class="close-btn" onclick="hideCart()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-items" id="cart-items">
            <!-- Cart items will be populated by JavaScript -->
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total">$0.00</span>
            </div>
            <button class="checkout-btn" onclick="checkout()">
                CHECKOUT
            </button>
        </div>
    </div>

    <script>
        // Application State
        let cart = [];
        let books = [];

        // Non-fiction books data
        const nonFictionBooks = [
            {
                id: 5,
                title: "The Art of War",
                author: "Sun Tzu",
                price: 9.99,
                category: "non-fiction",
                image: "⚔️"
            },
            {
                id: 11,
                title: "Sapiens",
                author: "Yuval Noah Harari",
                price: 18.99,
                category: "non-fiction",
                image: "🧠"
            },
            {
                id: 12,
                title: "The Power of Habit",
                author: "Charles Duhigg",
                price: 15.99,
                category: "non-fiction",
                image: "🔄"
            },
            {
                id: 13,
                title: "Atomic Habits",
                author: "James Clear",
                price: 16.99,
                category: "non-fiction",
                image: "⚛️"
            },
            {
                id: 14,
                title: "Thinking, Fast and Slow",
                author: "Daniel Kahneman",
                price: 17.99,
                category: "non-fiction",
                image: "🧭"
            },
            {
                id: 15,
                title: "The 7 Habits of Highly Effective People",
                author: "Stephen R. Covey",
                price: 14.99,
                category: "non-fiction",
                image: "📈"
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            books = nonFictionBooks;
            loadBooks();
            initializeBraze();
        });

        function initializeBraze() {
            braze.initialize('7ad461d4-5c54-45a1-a0f2-c018596c87ca', {
                baseUrl: "sondheim.braze.com",
                enableLogging: true,
                allowUserSuppliedJavascript: true
            });

            braze.toggleLogging();
            braze.changeUser('pjy');
            
            braze.openSession(() => {
                braze.requestContentCardsRefresh();
            });

            // Set user attributes
            const user = braze.getUser();
            user.setCustomUserAttribute('app_name', 'BookFlow');
            user.setCustomUserAttribute('current_page', 'non-fiction');
            user.setCustomUserAttribute('total_books', books.length);
        }

        function loadBooks() {
            const booksGrid = document.getElementById('books-grid');
            booksGrid.innerHTML = books.map(book => `
                <div class="book-card" onclick="addToCart(${book.id})">
                    <div class="book-image">
                        <span>${book.image}</span>
                    </div>
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">by ${book.author}</div>
                        <div class="book-price">$${book.price}</div>
                        <button class="add-to-cart-btn" onclick="event.stopPropagation(); addToCart(${book.id})">
                            ADD TO CART
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addToCart(bookId) {
            const book = books.find(b => b.id === bookId);
            if (book) {
                const existingItem = cart.find(item => item.id === bookId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({ ...book, quantity: 1 });
                }
                updateCart();
                
                // Track with Braze
                braze.logCustomEvent('Book Added to Cart', {
                    'book_title': book.title,
                    'book_author': book.author,
                    'book_price': book.price,
                    'book_category': book.category,
                    'cart_total': cart.length
                });
            }
        }

        function updateCart() {
            const cartCount = document.getElementById('cart-count');
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            cartCount.textContent = totalItems;
            cartTotal.textContent = `$${totalPrice.toFixed(2)}`;
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-image"></div>
                    <div class="cart-item-info">
                        <div class="cart-item-title">${item.title}</div>
                        <div class="cart-item-price">$${item.price} x ${item.quantity}</div>
                    </div>
                </div>
            `).join('');
        }

        function showCart() {
            document.getElementById('cart-sidebar').classList.add('open');
            
            // Track with Braze
            braze.logCustomEvent('Cart Opened', {
                'cart_items': cart.length,
                'cart_total': cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            });
        }

        function hideCart() {
            document.getElementById('cart-sidebar').classList.remove('open');
        }

        function checkout() {
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // Track with Braze
            braze.logPurchase('checkout', 'USD', cart.reduce((sum, item) => sum + (item.price * item.quantity), 0));
            
            alert('Thank you for your purchase!');
            cart = [];
            updateCart();
            hideCart();
        }

        function showUserMenu() {
            // Track with Braze
            braze.logCustomEvent('User Menu Opened');
            alert('User menu functionality coming soon!');
        }

        // Search functionality
        function searchBooks() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            const clearBtn = document.getElementById('search-clear-btn');
            const searchResultsSection = document.getElementById('search-results-section');
            
            // Show/hide clear button
            if (searchTerm.length > 0) {
                clearBtn.style.display = 'block';
            } else {
                clearBtn.style.display = 'none';
            }
            
            if (searchTerm === '') {
                // Hide search results if search is empty
                searchResultsSection.style.display = 'none';
                return;
            }
            
            // Track search with Braze
            braze.logCustomEvent('Book Search', {
                'search_term': searchTerm,
                'current_page': 'non-fiction'
            });
            
            // Search across all books
            const allBooks = [
                ...nonFictionBooks,
                // Add books from other categories
                { id: 1, title: "The Great Gatsby", author: "F. Scott Fitzgerald", price: 12.99, category: "fiction", image: "📚" },
                { id: 2, title: "To Kill a Mockingbird", author: "Harper Lee", price: 14.99, category: "fiction", image: "📖" },
                { id: 3, title: "1984", author: "George Orwell", price: 11.99, category: "sci-fi", image: "🔮" },
                { id: 4, title: "Steve Jobs", author: "Walter Isaacson", price: 16.99, category: "biography", image: "👨‍💼" },
                { id: 6, title: "Dune", author: "Frank Herbert", price: 15.99, category: "sci-fi", image: "🏜️" },
                { id: 7, title: "Pride and Prejudice", author: "Jane Austen", price: 10.99, category: "fiction", image: "💕" },
                { id: 8, title: "The Hobbit", author: "J.R.R. Tolkien", price: 13.99, category: "fiction", image: "🐉" },
                { id: 9, title: "Foundation", author: "Isaac Asimov", price: 12.99, category: "sci-fi", image: "🚀" },
                { id: 10, title: "Einstein: His Life and Universe", author: "Walter Isaacson", price: 18.99, category: "biography", image: "🧠" }
            ];
            
            const searchResults = allBooks.filter(book => 
                book.title.toLowerCase().includes(searchTerm) ||
                book.author.toLowerCase().includes(searchTerm) ||
                book.category.toLowerCase().includes(searchTerm)
            );
            
            displaySearchResults(searchResults, searchTerm);
        }

        function displaySearchResults(results, searchTerm) {
            const searchResultsSection = document.getElementById('search-results-section');
            const searchResultsGrid = document.getElementById('search-results-grid');
            
            if (results.length === 0) {
                searchResultsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: #666;">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No books found for "${searchTerm}"</h3>
                        <p>Try adjusting your search terms or browse our categories</p>
                    </div>
                `;
            } else {
                searchResultsGrid.innerHTML = results.map(book => `
                    <div class="search-result-card" onclick="addToCart(${book.id})">
                        <div class="search-result-image">
                            <span>${book.image}</span>
                        </div>
                        <div class="search-result-info">
                            <div class="search-result-title">${book.title}</div>
                            <div class="search-result-author">by ${book.author}</div>
                            <div class="search-result-price">$${book.price}</div>
                            <button class="search-result-cta" onclick="event.stopPropagation(); addToCart(${book.id})">
                                ADD TO CART
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            // Show search results section
            searchResultsSection.style.display = 'block';
            
            // Scroll to search results
            searchResultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            document.getElementById('search-clear-btn').style.display = 'none';
            document.getElementById('search-results-section').style.display = 'none';
            
            // Track with Braze
            braze.logCustomEvent('Search Cleared', {
                'current_page': 'non-fiction'
            });
        }

        function closeSearchResults() {
            document.getElementById('search-results-section').style.display = 'none';
            document.getElementById('search-input').value = '';
            document.getElementById('search-clear-btn').style.display = 'none';
        }
    </script>
</body>
</html> 